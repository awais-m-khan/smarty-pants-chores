<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smarty Pants Chores</title>
<style>
  /* Basic styling */
  body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    background-color: #f9f9f9;
  }
  h1 {
    color: #333;
  }
  .chore-container {
    width: 100%;
    max-width: 600px;
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
  }
  .name-section {
    margin: 10px 0;
    padding: 10px;
    border-bottom: 1px solid #ddd;
  }
  .name-section:last-child {
    border-bottom: none;
  }
  .name-section h2 {
    font-size: 1.2em;
    color: #555;
  }
  .chore {
    display: flex;
    align-items: center;
    margin: 5px 0;
  }
  .chore input {
    margin-right: 8px;
  }
  .generate-button, .date-navigation {
    padding: 10px 20px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 1em;
    cursor: pointer;
    margin-top: 20px;
  }
  .generate-button:hover, .date-navigation:hover {
    background-color: #45a049;
  }
  .all-chores-list {
    margin-top: 20px;
    font-size: 1.1em;
  }
</style>
</head>
<body>

<h1>Smarty Pants Chores</h1>
<div class="chore-container" id="choreContainer">
  <!-- Chore assignments will be dynamically inserted here -->
</div>
<button class="generate-button" id="generateButton" onclick="promptPassword()" style="display:none;">Generate Chores</button>
<div class="date-navigation">
  <button onclick="previousDay()">‚¨ÖÔ∏è Previous Day</button>
  <button onclick="nextDay()">Next Day ‚û°Ô∏è</button>
</div>

<div class="all-chores-list">
  <h2>Possible Chores:</h2>
  <ul>
    <li>üçΩÔ∏è Wash the dishes</li>
    <li>üßπ Vacuum</li>
    <li>üßº Clean the bathroom</li>
    <li>üß∫ General tidying</li>
    <li>üçµ Make tea</li>
    <li>üç≤ Make food</li>
    <li>ü§ó Hug mummy</li>
    <li>ü§ó Hug daddy</li>
    <li>üéâ Proclaim: "Your favourite mimi is the best!"</li>
  </ul>
</div>

<script>
  const nieces = ["Tahani", "Amaani", "Moina", "Haneeni Pie"];
  const chores = [
    { task: "Wash the dishes", emoji: "üçΩÔ∏è" },
    { task: "Vacuum", emoji: "üßπ" },
    { task: "Clean the bathroom", emoji: "üßº" },
    { task: "General tidying", emoji: "üß∫" },
    { task: "Make tea", emoji: "üçµ" },
    { task: "Make food", emoji: "üç≤" },
    { task: "Hug mummy", emoji: "ü§ó" },
    { task: "Hug daddy", emoji: "ü§ó" },
    { task: "Proclaim: 'Awais mimi is the best!'", emoji: "üéâ" }
  ];
  const password = 'eulbwob';
  const choreData = {}; // Store chore assignments for multiple days
  let currentDate = new Date().setHours(0, 0, 0, 0);
  
  // Generate unique chores for each niece
  function generateUniqueChores() {
    const selectedChores = [...chores];
    return nieces.map(() => {
      const randomIndex = Math.floor(Math.random() * selectedChores.length);
      const chore = selectedChores.splice(randomIndex, 1)[0];
      return chore;
    });
  }

  // Function to generate chores for the day
  function generateChoresForDay(date) {
    const dateString = new Date(date).toDateString();
    if (!choreData[dateString]) {
      const uniqueChores = generateUniqueChores();
      choreData[dateString] = nieces.map((niece, index) => {
        return { niece, chore: uniqueChores[index] };
      });
    }
    return choreData[dateString];
  }

  // Display chores
  function displayChores(date) {
    const container = document.getElementById("choreContainer");
    container.innerHTML = ""; // Clear previous assignments

    const dateString = new Date(date).toDateString();
    if (date < new Date().setHours(6, 0, 0, 0)) {
      container.innerHTML = "<p>Chores will populate at 6am, stay tuned smarties!</p>";
      return;
    }
    const todayChores = generateChoresForDay(date);

    todayChores.forEach(entry => {
      const nameSection = document.createElement("div");
      nameSection.className = "name-section";
      const nameTitle = document.createElement("h2");
      nameTitle.textContent = entry.niece;
      nameSection.appendChild(nameTitle);

      const choreDiv = document.createElement("div");
      choreDiv.className = "chore";
      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      const choreLabel = document.createElement("label");
      choreLabel.innerHTML = `${entry.chore.emoji} ${entry.chore.task}`;
      choreDiv.appendChild(checkbox);
      choreDiv.appendChild(choreLabel);
      nameSection.appendChild(choreDiv);

      container.appendChild(nameSection);
    });
  }

  // Password prompt for generating chores
  function promptPassword() {
    const enteredPassword = prompt("Enter the password to generate chores:");
    if (enteredPassword === password) {
      saveChoresToCSV(currentDate);
      alert("Chores generated and saved!");
    } else {
      alert("Incorrect password.");
    }
  }

  // Save chores to CSV
  function saveChoresToCSV(date) {
    const dateString = new Date(date).toDateString();
    const todayChores = generateChoresForDay(date);
    const csvContent = "data:text/csv;charset=utf-8," +
      todayChores.map(entry => `${entry.niece},${entry.chore.task}`).join("\n");

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", `chores_${dateString}.csv`);
    document.body.appendChild(link); // Required for Firefox
    link.click();
    document.body.removeChild(link);
  }

  // Navigate days
  function previousDay() {
    currentDate -= 24 * 60 * 60 * 1000;
    displayChores(currentDate);
  }

  function nextDay() {
    const today = new Date().setHours(0, 0, 0, 0);
    if (currentDate < today) {
      currentDate += 24 * 60 * 60 * 1000;
      displayChores(currentDate);
    }
  }

  // Show or hide generate button based on date
  function checkGenerateButton() {
    const today = new Date().setHours(0, 0, 0, 0);
    document.getElementById("generateButton").style.display = currentDate === today ? "block" : "none";
  }

  // Initialize display
  displayChores(currentDate);
  checkGenerateButton();
</script>

</body>
</html>
